<!DOCTYPE HTML>
<html lang="en">
    
<!-- Mirrored from wanteat.kwst.net/site/cart.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Feb 2024 08:24:32 GMT -->
<head>
        <!--=============== basic  ===============-->
        <meta charset="UTF-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>WantEat - Responsive Restaurant / Cafe / Pub Template</title>
        <!--=============== css  ===============-->	
        <link type="text/css" rel="stylesheet" href="css/plugins.css">
        <link type="text/css" rel="stylesheet" href="css/style.css">
        <!--=============== favicons ===============-->
        <link rel="shortcut icon" href="images/favicon.ico">
    </head>
    <body>
        <!--loader-->
        <div class="main-loader">
            <div class="loader-wrap">
                <span class="loader"></span>
            </div>
        </div>
        <!--loader end-->
        <!--  main   -->
        <div id="main">
            <a href="index.html" class="logo-holder"><img src="images/logo.png" alt=""></a>
            <!--  header  -->
            <header class="header_half">
                <div class="header-inner">
                    <div class="header-top_contacts"><a href="#"><span>Call now:</span> +489756412322</a><a href="#"><span>Write :</span> yourmail@domain.com</a></div>
                    <div class="share-btn show-share isShare"></div>
                    <!-- <div class="header_half-reser_btn show-rb"><span>Book Table</span><i class="fa-thin fa-bookmark"></i></div> -->
                    <div class="cart-btn sc_btn"><strong> Your Cart</strong><i class="fa-thin fa-basket-shopping-simple"></i><span id="cart-item-count" class="cart-btn_counter">0</span></div>
                    <div class="nav-button_wrap isvis_hid_menu">
                        <div class="nav-button"><span></span></div>
                    </div>
                    <!-- share-wrapper-->  
                    <div class="share-wrapper share-wrapper_half">
                        <div class="share-inner">
                            <div class="share-container"></div>
                        </div>
                    </div>
                    <!-- share-wrapper end -->									
                </div>
            </header>
            <!--  header end  -->
            <!--  header end  -->
            <!--  navigation -->
            <div class="hidden_menu-container">
                <div class="nav-wrapper isvis_menu hiddenmenu">
                    <div class="nav-separator"><span></span></div>
                    <div class="nav-wrap">
                        <div class="fl-wrap">
                            <div class="nav_dec"><span></span></div>
                        </div>
                        <div class="nav-container fl-wrap">
                            <!-- nav -->
                            <nav class="nav-inner" id="menu_init">
                                <ul>
                                    <li>
                                        <a href="index4.html">Home </a>
                                    </li>
                                    <li><a href="menu.html" class="act-link">  Menu</a></li>
                                </ul>
                            </nav>
                            <!-- nav end-->
                        </div>
                        <div class="fl-wrap">
                            <div class="nav_dec nd_bottom"><span></span></div>
                        </div>
                    </div>
                </div>
                <div class="body-ovelay  fs-wrapper"></div>
            </div>
            <!--  navigation  end-->
            <!--column-image-->
            <div class="column-image mob-hidden">
                <div class="border-bg">
                    <div class="bg"  data-bg="images/bg/long/1.jpg"></div>
                    <div class="overlay"></div>
                </div>
            </div>
            <!--column-image end-->			
            <!--column-wrap-->
            <div class="column-wrap single_colimn-wrap">
                <!--section-->
                <div class="content-section column-wrap-section   white-bg" data-scrollax-parent="true" id="sec2">
                    <div class="container small-container">
                        <div class="section-title">
                            <h4>Your wish list</h4>
                            <h2>Your Cart</h2>
                            <div class="section-title-separator_wrap">
                                <div class="section-title-separator"><span></span></div>
                            </div>
                        </div>
                        <!-- CHECKOUT TABLE -->
                        <div class="checkout-table-container">
                            <table class="table table-border checkout-table">
                                <tbody id="cart-items-body">
                                    <!-- Table rows will be dynamically generated here -->
                                </tbody>
                            </table>
                            <!-- COUPON -->
                            <div class="coupon-holder-wrap fl-wrap">
                                <div class="row">
                                    <div class="col-md-7">
                                    </div>
                                    <div class="col-md-5">
                                        <div class="total-box">
                                            <span class="total-item" id="total-price">Total:  $0</span>
                                            <!-- <a href="checkout.html" class="sb-det_btn">Proceed to Checkout</a>     -->
                                            <a class="sb-det_btn" onclick="placeOrder()"> Place Order</a> 
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- /COUPON -->
                        </div>
                        
                        <!-- /CHECKOUT TABLE -->
                    </div>
                    <div class="parallax-element" style="right: 20px; bottom: -50px"  data-scrollax="properties: { translateY: '-150px' }"><img src="images/bg/dec/3.png" alt=""></div>
                    <div class="parallax-element" style="left: 10%; top:20px" data-scrollax="properties: { translateY: '150px' }"><img src="images/bg/dec/4.png" alt=""></div>
                </div>
                <!--section end-->
            </div>
            <!--column-wrap end-->
            <!--footer  -->
            <div class="height-emulator fl-wrap"></div>
            <footer class="main-footer column_footer">
                <div class="main-footer_content fl-wrap">
                    <div class="container small-container">
                        <div class="footer-top">
                            <div class="row">
                                <div class="col-md-5">
                                    <div class="footer-social">
                                        <div class="footer-social-title">Follow us:</div>
                                        <ul>
                                            <li><a href="#" target="_blank"><i class="fa-brands fa-facebook-f"></i></a></li>
                                            <li><a href="#" target="_blank"><i class="fa-brands fa-instagram"></i></a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="footer-inner">
                            <div class="row">
                                <div class="col-md-5">
                                    <div class="footer-widget">
                                        <div class="footer-widget-title">About Us</div>
                                        <div class="footer-widget-content">
                                            <div class="footer-box">
                                                <p> Numerous commentators have also referred to the supposed restaurant owner's eccentric habit of touting for custom outside his establishment, dressed in aristocratic fashion and brandishing a sword.  </p>
                                            </div>
                                            <!-- <a href="about.html" class="footer-widget-content-link">Read more</a>                                                    	 -->
                                        </div>
                                    </div>
                                </div>
                                <!--footer social links-->
                                <!--subscribe form-->
                                <div class="col-md-4">
                                    <div class="footer-widget">
                                        <div class="footer-widget-title">Contact Info  </div>
                                        <div class="footer-widget-content">
                                            <div class="footer-contacts footer-box">
                                                <ul>
                                                    <li><span>Call :</span><a href="#">+489756412322</a> , <a href="#">+56897456123</a></li>
                                                    <li><span>Write  :</span><a href="#">yourmail@domain.com</a></li>
                                                    <li><span>Find us : </span><a href="#"> 27TH Brooklyn NY</a></li>
                                                </ul>
                                            </div>
                                            <!-- <a href="contacts.html" class="footer-widget-content-link">Get in Touch</a>                                                    	 -->
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="footer-widget">
                                        <div class="footer-widget-title">Opening Hours</div>
                                        <div class="footer-widget-content">
                                            <div class="footer-work-time_widget footer-box">
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <h6>Monday to Thurseday</h6>
                                                        <div class="footer-work-time">
                                                            10:00 AM<br>
                                                            10:00 PM
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <h6>Friday to Sunday</h6>
                                                        <div class="footer-work-time">
                                                            10:00 AM<br>
                                                            11:00 PM
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- <a href="#" class="footer-widget-content-link show-rb">Reserve Table</a>                                                    	 -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- subbfooter -->
                        <div class="subbfooter">
                            <div class="policy-box">
                                <span> &#169; Wanteat Restaurant 2024 </span>  /  All rights reserved.  
                            </div>
                            <div class="pay_list">
                                <ul>
                                    <li><i class="fa-brands fa-cc-visa"></i></li>
                                    <li><i class="fa-brands fa-cc-mastercard"></i></li>
                                    <li><i class="fa-brands fa-cc-paypal"></i></li>
                                </ul>
                            </div>
                            <div class="to-top-btn to-top"><i class="fa-solid fa-chevrons-up"></i></div>
                        </div>
                        <!-- subbfooter end -->					
                    </div>
                    <div class="footer-bg"></div>
                </div>
            </footer>
            <!--footer end-->
           
        </div>
        <!-- Main end -->
        <!--=============== scripts  ===============-->   
        <script  src="js/jquery.min.js"></script>
        <script  src="js/plugins.js"></script>
        <script  src="js/scripts.js"></script>
        <script>
            // document.addEventListener("DOMContentLoaded", function() {
    // Other JavaScript code
    
    // Function to place the order
    function placeOrder(flattenedCartItems,generateCartRows,updateCartUI,updateURLParams) {
    console.log("order======>", flattenedCartItems);
    const orderDetails = flattenedCartItems.map(item => ({
        name: item.name,
        quantity: item.quantity,
        price: item.price,
        imageLink: item.image
    }));
    // const tableNumber = 2; // You can set the table number dynamically if needed
    const tableNumber = flattenedCartItems[0].tableNumber ;
    console.log("tableNumber===========>",tableNumber);

    // Create the request body
    const requestBody = {
        tableNumber,
        orderDetails
    };

    // Make an AJAX request to place the order
    fetch('https://resturantapp.azurewebsites.net/api/v1/placeOrder', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestBody)
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Failed to place order');
            }
            return response.json();
        })
        .then(data => {
            // Handle successful response
            console.log(data.data);
           //alert a message 
           alert("Successfully order placed ");
            // Clear the cart UI
            flattenedCartItems.length = 0; // Reset flattenedCartItems to an empty array

            // Regenerate the cart UI
            generateCartRows(flattenedCartItems);

            // Update the cart item count UI
            updateCartUI(0);
           //update stored data 
           updateURLParams(flattenedCartItems);
         // Construct the URL with both tableNumber and orderId parameters
         var orderPageUrl = 'order.html?tableNumber=' + tableNumber + '&orderId=' + data.data._id;

        // Redirect to the order.html page with the tableNumber parameter
        window.location.href = orderPageUrl;
        })
        .catch(error => {
            // Handle errors
            console.error('Error placing order:', error);
            // Optionally, you can show an error message to the user
            alert(error.message);
        });
}
        </script>

        <script>
            document.addEventListener("DOMContentLoaded", function() {
                // Your JavaScript code here
                // Parse the query parameters from the URL
                const queryString = window.location.search;
                const urlParams = new URLSearchParams(queryString);
        
                // Initialize an empty array to store cart items
                const cartItems = [];
        
                // Loop through each parameter in the URL
                for (const [key, value] of urlParams.entries()) {
                    if (key === 'items') {
                        // Parse the 'items' parameter as JSON and push it to the cartItems array
                        const itemsArray = JSON.parse(decodeURIComponent(value));
                        cartItems.push(itemsArray);
                    }
                }
                updateCartUI(cartItems.length);
                console.log("cartItems====>",cartItems);
                // Update cart icon and count
                function updateCartUI(itemQuantity) {
                    const cartItemCount = document.getElementById('cart-item-count');
                    cartItemCount.textContent = itemQuantity ;
                }
        
                // Flatten the cartItems array if necessary
                const flattenedCartItems = cartItems.flat();
                //total amount 
        
                let totalAmout ;
                // Function to dynamically generate table rows for cart items
                function generateCartRows(cartItems) {
                    const tableBody = document.querySelector('.checkout-table tbody');
                    const totalPriceElement = document.getElementById('total-price');
                    let totalPrice = 0;
        
                    // Clear existing table rows
                    tableBody.innerHTML = '';
        
                    // Create header row
                    const headerRow = document.createElement('tr');
                    headerRow.innerHTML = `
                        <th class="hidden-xs">Item</th>
                        <th>Description</th>
                        <th class="hidden-xs">Price</th>
                        <th>Count</th>
                        <th>Total Price</th>
                        <th></th>
                    `;
                    tableBody.appendChild(headerRow);
        
                    // Loop through cart items and generate table rows
                    cartItems.forEach((item, index) => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td class="hidden-xs">
                                <a href="#"><img src="${item.image}" alt="" class="respimg"></a>
                            </td>
                            <td>
                                <h5 class="product-name"> <a href="#">${item.name}</a></h5>
                            </td>
                            <td class="hidden-xs">
                                <h5 class="order-money">$${item.price}</h5>
                            </td>
                            <td>
                                <div class="count-control">
                                    <button class="count-btn decrement">-</button>
                                    <input type="number" name="cartin" value="${item.quantity}" max="50" min="1" class="order-count">
                                    <button class="count-btn increment">+</button>
                                </div>
                            </td>
                            <td class="total-price">
                                <h5 class="order-money">$${item.price * item.quantity}</h5>
                            </td>
                            <td class="pr-remove">
                                <a href="#" title="Remove" data-index="${index}"><i class="fas fa-times"></i></a>
                            </td>
                        `;
        
                        // Update total price
                        totalPrice += item.price * item.quantity;
                        totalPriceElement.textContent = `Total: $${totalPrice}`;
        
                        tableBody.appendChild(row);
                    });
        
                    totalAmout = function updateTotalPrice() {
                        totalPrice = 0;
                        countInputs.forEach((input, index) => {
                            const itemTotal = input.value * flattenedCartItems[index].price;
                            totalPrice += itemTotal;
                            document.querySelectorAll('.total-price h5')[index].textContent = `$${itemTotal}`;
                        });
                        totalPriceElement.textContent = `Total: $${totalPrice}`;
                    }
        
                    // Add event listeners for count increment and decrement
                    const countInputs = document.querySelectorAll('.order-count');
                    countInputs.forEach(input => {
                        input.addEventListener('change', totalAmout);
                    });
        
                    // Add event listeners for increment and decrement buttons
                    const decrementBtns = document.querySelectorAll('.count-btn.decrement');
                    const incrementBtns = document.querySelectorAll('.count-btn.increment');
        
                    decrementBtns.forEach((btn, index) => {
                        btn.addEventListener('click', () => {
                            if (countInputs[index].value > 1) {
                                countInputs[index].value--;
                                totalAmout();
                            }
                        });
                    });
        
                    incrementBtns.forEach((btn, index) => {
                        btn.addEventListener('click', () => {
                            countInputs[index].value++;
                            totalAmout();
                        });
                    });
                }
        
                // Generate table rows for cart items
                generateCartRows(flattenedCartItems); // Pass the flattened array here
        
                // Function to remove an item from the cart and update the UI
                function removeCartItem(itemIndex) {
                    // Remove the item from the flattenedCartItems array
                    const removedItem = flattenedCartItems.splice(itemIndex, 1)[0];
                    console.log("removedItem====>", removedItem);
        
                    // Update the URL query parameters to reflect the changes
                    updateURLParams(flattenedCartItems);
        
                    // Regenerate table rows
                    generateCartRows(flattenedCartItems);
        
                    // Update cart item count
                    updateCartUI(flattenedCartItems.length);
        
                    //update total amount 
                    totalAmout();
        
                    // Reattach event listeners for remove buttons
                    attachRemoveButtonListeners();
                }
        
                // Function to attach event listeners for remove buttons
                function attachRemoveButtonListeners() {
                    const removeButtons = document.querySelectorAll('.pr-remove a');
                    removeButtons.forEach(button => {
                        button.addEventListener('click', function(e) {
                            e.preventDefault();
                            const itemIndex = parseInt(button.dataset.index); // Get the index of the clicked remove button from data-index attribute
                            removeCartItem(itemIndex);
                        });
                    });
                }
        
                // Attach initial event listeners for remove buttons
                attachRemoveButtonListeners();
        
                // Function to update the URL query parameters
                function updateURLParams(cartItems) {
                    const newParams = cartItems.map(item => `items=${encodeURIComponent(JSON.stringify(item))}`).join('&');
                    const newURL = window.location.pathname + '?' + newParams;
                    window.history.replaceState({}, '', newURL);
                }
        // Add event listener to the "Place Order" button
const placeOrderButton = document.querySelector('.sb-det_btn');
placeOrderButton.addEventListener('click', function() {
    placeOrder(flattenedCartItems,generateCartRows,updateCartUI,updateURLParams); // Call placeOrder function when the button is clicked
});



                
       });
            // });
        </script>
        
    </body>

<!-- Mirrored from wanteat.kwst.net/site/cart.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Feb 2024 08:24:32 GMT -->
</html>