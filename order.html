<!DOCTYPE html>
<html lang="en">
<!-- Mirrored from wanteat.kwst.net/site/cart.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Feb 2024 08:24:32 GMT -->

<head>
  <!--=============== basic  ===============-->
  <meta charset="UTF-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <title>WantEat - Responsive Restaurant / Cafe / Pub Template</title>
  <!--=============== css  ===============-->
  <link type="text/css" rel="stylesheet" href="css/plugins.css" />
  <link type="text/css" rel="stylesheet" href="css/style.css" />
  <!-- <link type="text/css" rel="stylesheet"  href="css/print.css" media="print"> -->
  <!-- <link rel="stylesheet" type="text/css" href="print.css"> -->
  <!--=============== favicons ===============-->
  <link rel="shortcut icon" href="images/favicon.ico" />
  <style>
    .invoice-table {
      width: 100%;
      border-collapse: collapse;
    }

    .invoice-table th,
    .invoice-table td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }

    .invoice-table th {
      background-color: #f2f2f2;
    }

    .payment-dialog {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #fff;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 5px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      z-index: 9999;
    }

    .payment-dialog p {
      margin: 0 0 10px;
    }

    .payment-dialog button {
      margin-right: 10px;
      padding: 10px 20px;
      cursor: pointer;
    }

    .payment-dialog button:last-child {
      margin-right: 0;
    }
    .red-x {
    color: red; /* Set the color to red */
}
.button-container {
    display: flex;
    flex-direction: row;
}

.sb-det_btn {
    margin-right: 10px; /* Adjust as needed */
}

  </style>
</head>

<body>
  <!--loader-->
  <div class="main-loader">
    <div class="loader-wrap">
      <span class="loader"></span>
    </div>
  </div>
  <!--loader end-->
  <!--  main   -->
  <div id="main">
    <a class="logo-holder"><img src="images/logo.png" alt="" /></a>
    <!--  header  -->
    <header class="header_half">
      <div class="header-inner">
        <div class="header-top_contacts">
          <a href="#"><span>Call now:</span> +489756412322</a><a href="#"><span>Write :</span> yourmail@domain.com</a>
        </div>
        <div class="share-btn show-share isShare"></div>
        <!-- <div class="header_half-reser_btn show-rb"><span>Book Table</span><i class="fa-thin fa-bookmark"></i></div> -->
        <a>
        <div class="cart-btn sc_btn"  onclick="openCart()">
          <strong> Your Cart</strong><i class="fa-thin fa-basket-shopping-simple"></i><span id="cart-item-count"
            class="cart-btn_counter">0</span>
        </div>
      </a>
        <div class="nav-button_wrap isvis_hid_menu" id="home_menu_opt">
          <div class="nav-button"><span></span></div>
        </div>
        <!-- share-wrapper-->
        <div class="share-wrapper share-wrapper_half">
          <div class="share-inner">
            <div class="share-container"></div>
          </div>
        </div>
        <!-- share-wrapper end -->
      </div>
    </header>
    <!--  header end  -->
    <!--  header end  -->
    <!--  navigation -->
    <div class="hidden_menu-container">
      <div class="nav-wrapper isvis_menu hiddenmenu">
        <div class="nav-separator"><span></span></div>
        <div class="nav-wrap">
          <div class="fl-wrap">
            <div class="nav_dec"><span></span></div>
          </div>
          <div class="nav-container fl-wrap">
            <!-- nav -->
            <nav class="nav-inner" id="menu_init">
              <ul>
                <li id="home_icon">
                  <a href="index.html">Home </a>
                </li>
                <li><a href="menu.html" class="act-link"> Menu</a></li>
              </ul>
            </nav>
            <!-- nav end-->
          </div>
          <div class="fl-wrap">
            <div class="nav_dec nd_bottom"><span></span></div>
          </div>
        </div>
      </div>
      <div class="body-ovelay fs-wrapper"></div>
    </div>
    <!--  navigation  end-->
    <!--column-image-->
    <div class="column-image mob-hidden">
      <div class="border-bg">
        <div class="bg" data-bg="images/bg/long/6.jpg"></div>
        <div class="overlay"></div>
      </div>
    </div>
    <!--column-image end-->
    <!--column-wrap-->
    <div class="column-wrap single_colimn-wrap">
      <!--section-->
      <div class="content-section column-wrap-section white-bg" data-scrollax-parent="true" id="sec2">
        <div class="container small-container">
          <div class="section-title">
            <button id="backButton" class="back_half-reser_btn_mob">Back</button>
            <h4>Your Ordered list</h4>
            <h2>Your Order</h2>
            <h2 id="table-number">Table Number : tableNumber</h2>
            <div class="section-title-separator_wrap">
              <div class="section-title-separator"><span></span></div>
            </div>
          </div>
          <!-- CHECKOUT TABLE -->
          <div class="checkout-table-container">
            <table class="table table-border checkout-table">
              <tbody id="cart-items-body">
                <!-- Table rows will be dynamically generated here -->
              </tbody>
            </table>
            <!-- COUPON -->
            <div class="coupon-holder-wrap fl-wrap">
              <div class="row">
                <div class="col-md-7"></div>
                <div class="col-md-5">
                  <div class="total-box">
                    <span class="total-item" id="total-price">Total: â‚¹ 0 /-</span>
                  </div>
                  <div id="invoice-content">
                    <div class="button-container">
                        <button class="sb-det_btn" id="generate-invoice-btn">Invoice</button>
                        <button class="sb-det_btn" id="make-payment-btn">Payment</button>
                        <a>
                            <button class="sb-det_btn" id="add-foods-btn" onclick="openMenu()">Add Foods</button>
                        </a>
                    </div>
                    <div id="invoice-content" style="display: none;"></div>
                    <div id="payment-dialog" class="payment-dialog">
                        <p>Choose payment method:</p>
                        <button id="cash-btn">Cash</button>
                        <button id="online-btn">Online</button>
                    </div>
                </div>
                
                </div>
              </div>
            </div>
            <!-- /COUPON -->
          </div>

          <!-- /CHECKOUT TABLE -->
        </div>
        <div class="parallax-element" style="right: 20px; bottom: -50px"
          data-scrollax="properties: { translateY: '-150px' }">
          <img src="images/bg/dec/3.png" alt="" />
        </div>
        <div class="parallax-element" style="left: 10%; top: 20px" data-scrollax="properties: { translateY: '150px' }">
          <img src="images/bg/dec/4.png" alt="" />
        </div>
      </div>
      <!--section end-->
    </div>
    <!--column-wrap end-->
    <!--footer  -->
    <div class="height-emulator fl-wrap"></div>
    <footer class="main-footer column_footer">
      <div class="main-footer_content fl-wrap">
        <div class="container small-container">
          <div class="footer-top">
            <div class="row">
              <div class="col-md-5">
                <div class="footer-social">
                  <div class="footer-social-title">Follow us:</div>
                  <ul>
                    <li>
                      <a href="#" target="_blank"><i class="fa-brands fa-facebook-f"></i></a>
                    </li>
                    <li>
                      <a href="#" target="_blank"><i class="fa-brands fa-instagram"></i></a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          <div class="footer-inner">
            <div class="row">
              <div class="col-md-5">
                <div class="footer-widget">
                  <div class="footer-widget-title">About Us</div>
                  <div class="footer-widget-content">
                    <div class="footer-box">
                      <p>
                        Numerous commentators have also referred to the
                        supposed restaurant owner's eccentric habit of touting
                        for custom outside his establishment, dressed in
                        aristocratic fashion and brandishing a sword.
                      </p>
                    </div>
                    <!-- <a href="about.html" class="footer-widget-content-link">Read more</a>                                                    	 -->
                  </div>
                </div>
              </div>
              <!--footer social links-->
              <!--subscribe form-->
              <div class="col-md-4">
                <div class="footer-widget">
                  <div class="footer-widget-title">Contact Info</div>
                  <div class="footer-widget-content">
                    <div class="footer-contacts footer-box">
                      <ul>
                        <li>
                          <span>Call :</span><a href="#">+489756412322</a> ,
                          <a href="#">+56897456123</a>
                        </li>
                        <li>
                          <span>Write :</span><a href="#">yourmail@domain.com</a>
                        </li>
                        <li>
                          <span>Find us : </span><a href="#"> 27TH Brooklyn NY</a>
                        </li>
                      </ul>
                    </div>
                    <!-- <a href="contacts.html" class="footer-widget-content-link">Get in Touch</a>                                                    	 -->
                  </div>
                </div>
              </div>
              <div class="col-md-3">
                <div class="footer-widget">
                  <div class="footer-widget-title">Opening Hours</div>
                  <div class="footer-widget-content">
                    <div class="footer-work-time_widget footer-box">
                      <div class="row">
                        <div class="col-md-6">
                          <h6>Monday to Thurseday</h6>
                          <div class="footer-work-time">
                            10:00 AM<br />
                            10:00 PM
                          </div>
                        </div>
                        <div class="col-md-6">
                          <h6>Friday to Sunday</h6>
                          <div class="footer-work-time">
                            10:00 AM<br />
                            11:00 PM
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- <a href="#" class="footer-widget-content-link show-rb">Reserve Table</a>                                                    	 -->
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- subbfooter -->
          <div class="subbfooter">
            <div class="policy-box">
              <span> &#169; Wanteat Restaurant 2024 </span> / All rights
              reserved.
            </div>
            <div class="pay_list">
              <ul>
                <li><i class="fa-brands fa-cc-visa"></i></li>
                <li><i class="fa-brands fa-cc-mastercard"></i></li>
                <li><i class="fa-brands fa-cc-paypal"></i></li>
              </ul>
            </div>
            <div class="to-top-btn to-top">
              <i class="fa-solid fa-chevrons-up"></i>
            </div>
          </div>
          <!-- subbfooter end -->
        </div>
        <div class="footer-bg"></div>
      </div>
    </footer>
    <!--footer end-->
  </div>
  <!-- Main end -->
  <!--=============== scripts  ===============-->
  <script src="js/jquery.min.js"></script>
  <script src="js/plugins.js"></script>
  <script src="js/scripts.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
    const userRole = localStorage.getItem('userRole');
    console.log("userRole========>", userRole);

    // Remove extra spaces and convert to lowercase for consistent comparison
    const cleanedUserRole = userRole ? userRole.trim().toLowerCase() : '';

    const homeIcon = document.getElementById('home_icon');
    if (!cleanedUserRole || cleanedUserRole === 'user') {
        homeIcon.style.display = 'none';
    } else {
        homeIcon.style.display = 'block';
    }
});

  </script>
  <script>
    let tablenUMForMenu ;
   let cartItemsForUI = JSON.parse(sessionStorage.getItem('cart'));
const cartItemCount = document.getElementById('cart-item-count');

if (!cartItemsForUI || cartItemsForUI.length === 0) {
    cartItemCount.textContent = '0';
} else {
    cartItemCount.textContent = cartItemsForUI.length;
}

    const userRoleInLocalStorage = localStorage.getItem('userRole');
   //Retrieve stored cart from sessionStorage
// let cartItems = JSON.parse(sessionStorage.getItem('cartInOrder')) || [];
    function updateTotalPrice(totalAmount) {
            const totalPriceElement = document.getElementById("total-price");
            totalPriceElement.textContent = `Total: â‚¹ ${totalAmount} /-`;
        };

        function removeCartItem(index, tableNumber, userRoleForUpdate, removedItem) {
          console.log("removedItem======>", removedItem);
    // const orderDetails = JSON.parse(sessionStorage.getItem('cartInOrder')) || [];
    // const removedItem = orderDetails.splice(index, 1)[0];
    // sessionStorage.setItem('cartInOrder', JSON.stringify(orderDetails));

    // Call your backend API to mark the item as canceled
    fetch('https://resturantapp.azurewebsites.net/api/v1/updateOrder', {
        method: 'PUT',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            orderDetails: [{ name: removedItem, action: 'cancel' }],
            tableNumber: tableNumber,
            role: userRoleForUpdate
        }),
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Failed to remove order');
        }
        // Parse JSON response
        return response.json();
    })
        .then(data => {
        console.log("Response after remove:", data);
        // Update the UI
        // const updatedOrderDetails = JSON.parse(sessionStorage.getItem('cartInOrder')) || [];
        const updatedOrderDetails = data.data.orderDetails ;
        sessionStorage.setItem('unPaidItemsQnt', updatedOrderDetails.length);
        generateCartRows(updatedOrderDetails, data.data.tableNumber, userRoleInLocalStorage );
        //orderDetails, tableNumber, userRoleInApi
        updateTotalPrice(updatedOrderDetails.reduce((total, item) => total + item.totalPrice, 0));
    })
    .catch(error => console.error('Error removing item:', error));
}

function incrementQuantity(index, tableNumber, userRoleForUpdate, orderDetails) {
  console.log("orderDetails in increment===>", orderDetails);
  orderDetails[index].quantity++;
  orderDetails[index].totalPrice = orderDetails[index].price * orderDetails[index].quantity;
  updateOrder([{ name: orderDetails, action: 'increase', quantity: 1 }], userRoleForUpdate, tableNumber);
}


function decrementQuantity(index, tableNumber, userRoleForUpdate, orderDetails, quantity) {
  console.log("orderDetails in decrement ===>", orderDetails, "====quantity",quantity) ;
    // const orderDetails = JSON.parse(sessionStorage.getItem('cartInOrder')) || [];
    if (quantity > 1) {
       quantity--;
        // orderDetails[index].totalPrice = orderDetails[index].price * orderDetails[index].quantity;
        // sessionStorage.setItem('cartInOrder', JSON.stringify(orderDetails));

        // Call your backend API to update the order details
        updateOrder([{ name: orderDetails, action: 'decrease', quantity: 1 }],userRoleForUpdate, tableNumber);
    }
}

function updateOrder(orderDetails, userRoleForUpdate, tableNumber) {
  console.log("orderDetails in update ===>", orderDetails);
    fetch('https://resturantapp.azurewebsites.net/api/v1/updateOrder', {
        method: 'PUT',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            orderDetails: orderDetails,
            tableNumber: tableNumber,
            role: userRoleForUpdate
        }),
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Failed to update order');
        }
        // Parse JSON response
        return response.json();
    })
    .then(data => {
        console.log("Response after update:", data);
        // Update the UI
        // const updatedOrderDetails = JSON.parse(sessionStorage.getItem('cartInOrder')) || [];
        const updatedOrderDetails = data.data.orderDetails ;
        generateCartRows(updatedOrderDetails, data.data.tableNumber, userRoleInLocalStorage);
        updateTotalPrice(updatedOrderDetails.reduce((total, item) => total + item.totalPrice, 0));
    })
    .catch(error => console.error('Error updating order:', error));
}




        function updateQuantity(index, newQuantity) {
            cartItems[index].quantity = parseInt(newQuantity);
            cartItems[index].totalPrice = cartItems[index].price * parseInt(newQuantity);
            // sessionStorage.setItem('cartInOrder', JSON.stringify(cartItems));
            generateCartRows(cartItems);
        }

        // const payBillBtn = document.getElementById("make-payment-btn");
        // payBillBtn.addEventListener("click", showPaymentDialog);

    function generateInvoice(orderId, orderDetails, tableNumber, totalAmountOfOrder) {
      console.log("orderId in invoice", orderId);
      // Make a POST request to the backend endpoint to generate the invoice
      fetch("https://resturantapp.azurewebsites.net/api/v1/generate-invoice", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          orderId: orderId,
          // orderDetails,
          tableNumber: tableNumber,
          totalAmount: totalAmountOfOrder
        })
      })
        .then(response => response.json())
        .then(data => {
          console.log(data.invoiceData, "==========invoiceData");
          // Open a new window for the invoice
          const invoiceWindow = window.open('', '_blank');
          invoiceWindow.document.write('<html><head><title>Invoice</title></head><body>');

          // Create table element
          const table = invoiceWindow.document.createElement("table");
          table.classList.add("invoice-table");

          // Create header row
          const headerRow = table.insertRow();
          const billOfTableNumberHeader = invoiceWindow.document.createElement("th");
          billOfTableNumberHeader.textContent = `Bill of Table Number: ${tableNumber}`;
          billOfTableNumberHeader.setAttribute("colspan", "3");
          headerRow.appendChild(billOfTableNumberHeader);

          // Create table header
          const headerRow2 = table.insertRow();
          const headerCell1 = headerRow2.insertCell(0);
          headerCell1.textContent = "Item";
          const headerCell2 = headerRow2.insertCell(1);
          headerCell2.textContent = "Quantity";
          const headerCell3 = headerRow2.insertCell(2);
          headerCell3.textContent = "Price";

          // Loop through order details to populate the table
          data.invoiceData.orderDetails.forEach((item) => {
            const row = table.insertRow();
            const cell1 = row.insertCell(0);
            cell1.textContent = item.name;
            const cell2 = row.insertCell(1);
            cell2.textContent = item.quantity;
            const cell3 = row.insertCell(2);
            cell3.textContent = `${item.totalPrice} /-`;
            cell3.textContent = `${item.totalPrice} /-`;
          });

          // Add total row
          const totalRow = table.insertRow();
          const totalCell = totalRow.insertCell(0);
          totalCell.colSpan = 2;
          totalCell.textContent = "Total Amount:";
          const totalAmountCell = totalRow.insertCell(1);
          totalAmountCell.textContent = `${data.invoiceData.totalAmountOfOrder} /-`;

          // Append the table to the invoice content
          invoiceWindow.document.body.appendChild(table);

          // Delay for a short time to ensure content is fully loaded
          setTimeout(() => {
            // Print the invoice
            invoiceWindow.print();
            // Close the invoice window after printing
            invoiceWindow.close();
            // Redirect back to order.html with tableNumber and order id
            var refetchUrl = 'order.html?tableNumber=' + data.invoiceData.tableNumber + '&orderId=' + data.invoiceData.orderId;
            window.location.href = refetchUrl;
            // Redirect back to order.html with tableNumber and orderId
            // window.location.href = `order.html?tableNumber=${tableNumber}&orderId=${orderId}`;

          }, 1000); // Adjust the delay as needed
        })
        .catch(error => {
          console.error("Error generating invoice:", error);
        });
    }


    //payment button___________________________________

    function paymentForOrder(orderId, onlinePayment) {
      console.log("payment donefor :--", orderId);
      // Make a POST request to the backend endpoint to generate the invoice
      fetch("https://resturantapp.azurewebsites.net/api/v1/payBill", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          orderId: orderId,
          onlinePayment: onlinePayment
        })
      })
        .then(response => response.json())
        .then(data => {
          console.log("Payment response: ", data.message);
          //update unPaidItemsQnt of sessionstorage
          sessionStorage.setItem('unPaidItemsQnt', 0);
          alert(data.message);
          // Clear the cart items from localStorage
          localStorage.removeItem('cartItems');
          // Clear the table number items from localStorage
          localStorage.removeItem('tableNumber');
          //refresh the page 
          window.location.reload();
        })
        .catch(error => {
          console.error("Error making payment:", error);
          alert(error.message);
        });
    }

    document.addEventListener("DOMContentLoaded", function () {

      const backButton = document.getElementById("backButton");
  console.log("clicking back button====");
  // Check if the back button element is found
  if (backButton) {
    // Add event listener to the back button
    backButton.addEventListener('click', function() {
      console.log("calling the back button");
      window.history.back();
    });
  } else {
    console.error("Back button element not found.");
  }
      // Clear the cart items from localStorage
      localStorage.removeItem('cartItems');
      // Function to get the tableNumber parameter from the URL
      function getTableNumberFromURL() {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get('tableNumber');
      }

      // Function to get the orderId parameter from the URL
      function getOrderIdFromURL() {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get('orderId');
      }

      // Get the tableNumber and orderId from the URL
      const tableNumber = getTableNumberFromURL();
      // const tableNumber = sessionStorage.getItem('tableNumber')
      const orderIdFromUrl = getOrderIdFromURL();

      // Now you can use the tableNumber and orderId as needed in your code
      console.log("=============Table Number:", tableNumber);
      console.log("=============Order ID:", orderIdFromUrl);

      // Retrieve user role from localStorage
      const userRole = localStorage.getItem('userRole');

      const generateInvoiceBtn = document.getElementById("generate-invoice-btn");
      const makePaymentBtn = document.getElementById("make-payment-btn");
      if (userRole === "Admin") {
        generateInvoiceBtn.style.display = "block";
        makePaymentBtn.style.display = "block";
      } else {
        generateInvoiceBtn.style.display = 'none';
        makePaymentBtn.style.display = 'none';

      }

      fetch(`https://resturantapp.azurewebsites.net/api/v1/getOrder?tableNumber=${tableNumber}&orderId=${orderIdFromUrl}`)
    .then((response) => response.json())
    .then((cartItems) => {
        console.log("order items for paid or not ======>", cartItems);
        // Retrieve user role from localStorage
        const userRoleInApi = localStorage.getItem('userRole');
        console.log("userRoleInApi====>", userRoleInApi);
        if ((cartItems.message === "Bill already paid" || cartItems.message === "No Pending Order Found") &&  ["Admin", "Chef", "Captain"].includes(userRoleInApi)) {
            window.location.href = 'alltables.html';
        } else if (cartItems.message === "Bill already paid") {
            window.location.replace('shop.html');
        }

        if (!cartItems || !cartItems.success || !cartItems.orderData || !cartItems.orderData.orderDetails) {
            const generateInvoiceBtnInApi = document.getElementById("generate-invoice-btn");
            const makePaymentBtnInApi = document.getElementById("make-payment-btn");
            generateInvoiceBtnInApi.style.display = 'none';
            makePaymentBtnInApi.style.display = 'none';
            throw new Error("Invalid menu data format");
        }

        const orderDetails = cartItems.orderData.orderDetails;
        const totalAmountOfOrder = cartItems.orderData.totalAmount;
        const orderId = cartItems.orderData._id;
        const tableNumber = cartItems.orderData.tableNumber;
        console.log("tableNumber after geting order===>", tableNumber);
        tablenUMForMenu = tableNumber ;
      // Retrieve stored cart from sessionStorage
      // const storedCart = JSON.parse(sessionStorage.getItem('cartInOrder')) || [];
// console.log();
// Merge stored cart with fetched order details
// const mergedCart = [...storedCart, ...orderDetails];
// Update the cart items in sessionStorage
// sessionStorage.setItem('cartInOrder', JSON.stringify(orderDetails));
  // Generate table rows for cart items
        generateCartRows(orderDetails, tableNumber, userRoleInApi);
         // Update total price in the UI
        updateTotalPrice(totalAmountOfOrder);
        const tableNumberElement = document.getElementById('table-number');
       tableNumberElement.textContent = "Table Number : " + tableNumber;
        const generateInvoiceBtn = document.getElementById("generate-invoice-btn");
        generateInvoiceBtn.addEventListener("click", function () {
            generateInvoice(orderId, orderDetails, tableNumber, totalAmountOfOrder);
        });

        function showPaymentDialog() {
            const paymentDialog = document.getElementById("payment-dialog");
            paymentDialog.style.display = "block";

            const cashBtn = document.getElementById("cash-btn");
            cashBtn.addEventListener("click", function () {
              paymentDialog.style.display = "none";
              paymentForOrder(orderId, false); // Payment with cash
            });

            const onlineBtn = document.getElementById("online-btn");
            onlineBtn.addEventListener("click", function () {
              paymentDialog.style.display = "none";
              paymentForOrder(orderId, true); // Payment online
            });
          }

          const payBillBtn = document.getElementById("make-payment-btn");
          payBillBtn.addEventListener("click", showPaymentDialog);

        })
    .catch((error) => {
        console.error("Error fetching order data:", error);
    });

    
      // Function to update total price in the UI
      function updateTotalPrice(totalAmount) {
        const totalPriceElement = document.getElementById("total-price");
        totalPriceElement.textContent = `Total:â‚¹ ${totalAmount} /-`;
      };

    });

    function generateCartRows(orderDetails, tableNumber, userRoleInApi) {
      console.log("orderDetails in generate row ===>", orderDetails);
            const tableBody = document.querySelector(".checkout-table tbody");
            let totalPrice = 0;

            tableBody.innerHTML = "";

            const headerRow = document.createElement("tr");
            headerRow.innerHTML = `
                <th class="hidden-xs">Item</th>
                <th>Name</th>
                <th>Quantity</th>
                <th>Price</th>
                <th>Time</th>
                ${userRoleInApi ? '<th id="cancel_btn">Cancel</th>' : ''}
            `;
            tableBody.appendChild(headerRow);

            orderDetails.forEach((item, index) => {
              // console.log("after foreach ==>", item);
        const row = document.createElement("tr");
        const orderTimeUTC = new Date(item.placedTime);
        const localOrderTime = orderTimeUTC.toLocaleString();

        // Add a class to the "x" icon based on the item's action
        const cancelClass = item.action === "cancel" ? "red-x" : "";
        let uidesign ;
if(userRoleInApi == null || userRoleInApi == undefined){
  console.log("for customer=====");
  uidesign =
  `
                    <td class="hidden-xs">
                        <a href="#"><img src="${item.imageLink}" alt="" class="respimg"></a>
                    </td>
                    <td>
                        <h5 class="product-name"> <a href="#">${item.name}</a></h5>
                    </td>
                    <td>
                        <h5 class="product-quantity"> ${item.quantity}</h5>
                    </td>
                    <td>
                        <h5 class="order-money">â‚¹ ${item.totalPrice} /-</h5>
                    </td>
                    <td>
                        <h5 class="order-money">${localOrderTime}</h5>
                    </td>       
                `;
}else{
  console.log("for restaurant====");
  uidesign = ` <td class="hidden-xs">
                <a href="#"><img src="${item.imageLink}" alt="" class="respimg"></a>
            </td>
            <td>
                <h5 class="product-name"> <a href="#">${item.name}</a></h5>
            </td>
            <td style="text-align: center;">
                <div class="count-control" style="display: flex; align-items: center; justify-content: center;">
                    <button class="count-btn decrement" style="margin-right: 3px; margin-left: 5px;" onclick="decrementQuantity(${index}, ${tableNumber}, '${userRoleInApi}', '${item.name}', ${item.quantity})">-</button>
                    <input type="number" name="cartin" value="${item.quantity}" max="50" min="1" class="order-count" onchange="updateQuantity(${index}, this.value)">
                    <button class="count-btn increment" style="margin-left: 3px; margin-right: 5px;" onclick="incrementQuantity(${index}, ${tableNumber},'${userRoleInApi}', '${item.name}')">+</button>
                </div>
            </td>
            <td>
                <h5 class="order-money">â‚¹ ${item.totalPrice} /-</h5>
            </td>
            <td>
                <h5 class="order-money">${localOrderTime}</h5>
            </td>
            <td class="pr-remove">
              <a href="#" title="Remove" data-index="${index}" onclick="removeCartItem(${index}, ${tableNumber}, '${userRoleInApi}', '${item.name}')"><i class="fas fa-times ${cancelClass}"></i></a>
            </td>`
}
        row.innerHTML = uidesign;

        totalPrice += item.totalAmount;
        tableBody.appendChild(row);
    });
}
    // const TableNumberForUI = sessionStorage.getItem('tableNumber');
        // Update the DOM to display the table number
    // const tableNumberElement = document.getElementById('table-number');
    // tableNumberElement.textContent = "Table Number : " + TableNumberForUI;
    function openMenu() {
      // Redirect to the menu page with atblkeNumber 
      var menuPageURL = 'menu.html?tableNumber=' + tablenUMForMenu ;

      // Redirect to the order.html page with the tableNumber parameter
      window.location.href = menuPageURL;
      console.log("Open menu clicked");
    }

    function openCart() {
        // console.log(cartItems[0].tableNumber ,"=================table number form cart");
      // Redirect to the menu page with atblkeNumber 
      var orderPageURL = 'cart.html?tableNumber=' + tablenUMForMenu;

      // Redirect to the order.html page with the tableNumber parameter
      window.location.href = orderPageURL;
      console.log("Open cart clicked");
    }
        
  </script>


</body>

<!-- Mirrored from wanteat.kwst.net/site/cart.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Feb 2024 08:24:32 GMT -->

</html>